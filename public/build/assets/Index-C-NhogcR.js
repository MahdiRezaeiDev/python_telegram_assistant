import{r as o,j as e,H as D,b as m}from"./app-BqfSY66W.js";import{A as L}from"./AuthenticatedLayout-BD6RdAD5.js";import{T as M,t as i}from"./index-BiFnSlCp.js";import{L as E}from"./loader-circle-DQ-HXIqi.js";import{S as A}from"./square-pen-BaXj2PVX.js";import{T as H}from"./trash-2-By46AzIZ.js";import"./transition-CYzJCn0g.js";import"./createLucideIcon-Hng2jIgv.js";import"./index-CjicLJss.js";function Q({sellers:b=[]}){const[y,u]=o.useState(b),[j,h]=o.useState(b.reduce((t,s)=>({...t,[s.id]:s.view}),{})),[C,w]=o.useState({}),[V,N]=o.useState(!1),[d,z]=o.useState(null),[r,p]=o.useState({full_name:"",phone:""}),[v,k]=o.useState(!1),[c,f]=o.useState(null),_=async t=>{const s=!j[t];h(a=>({...a,[t]:s})),w(a=>({...a,[t]:!0}));try{const l=(await m.post(route("sellers.toggleView",t),{view:s})).data.updatedSeller;l&&u(n=>n.map(x=>x.id===t?l:x)),i.success("وضعیت نمایش فروشنده تغییر یافت",{position:"bottom-left",style:{backgroundColor:"seagreen",color:"white",fontFamily:"Vazir"}})}catch(a){console.error(a),h(l=>({...l,[t]:!s})),i.error("خطا در تغییر وضعیت فروشنده!",{position:"bottom-left",style:{backgroundColor:"red",color:"white",fontFamily:"Vazir"}})}finally{w(a=>({...a,[t]:!1}))}},S=(t=null)=>{z(t),p(t?{full_name:t.full_name,phone:t.phone}:{full_name:"",phone:""}),N(!0)},g=()=>N(!1),F=async t=>{t.preventDefault(),k(!0);try{let s;d?s=await m.post(route("sellers.update",d.id),{...r,_method:"PUT"}):s=await m.post(route("sellers.store"),r);const a=s.data,l=a.updatedSeller||a.newSeller;u(n=>d?n.map(x=>x.id===d.id?l:x):[...n,l]),h(n=>({...n,[l.id]:l.view})),i.success(a.message,{position:"bottom-left",style:{backgroundColor:"seagreen",color:"white",fontFamily:"Vazir"}}),g()}catch(s){console.error(s),i.error("خطا در ذخیره فروشنده!",{position:"bottom-left",style:{backgroundColor:"red",color:"white",fontFamily:"Vazir"}})}finally{k(!1)}},T=async()=>{if(c)try{await m.delete(route("sellers.destroy",c.id)),u(t=>t.filter(s=>s.id!==c.id)),f(null),i.success("فروشنده با موفقیت حذف شد",{position:"bottom-left",style:{backgroundColor:"seagreen",color:"white",fontFamily:"Vazir"}})}catch(t){console.error(t),i.error("خطا در حذف فروشنده!",{position:"bottom-left",style:{backgroundColor:"red",color:"white",fontFamily:"Vazir"}})}};return e.jsxs(L,{title:"لیست فروشنده‌ها",children:[e.jsx(D,{title:"مدیریت فروشنده‌ها"}),e.jsx(M,{richColors:!0}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"مدیریت فروشنده‌ها"}),e.jsx("button",{onClick:()=>S(),className:"inline-flex items-center gap-2 rounded bg-cyan-700 px-4 py-2 text-sm font-semibold text-white shadow transition hover:bg-green-700",children:"افزودن فروشنده جدید"})]}),e.jsx("div",{className:"overflow-x-auto rounded border border-gray-200 p-1 shadow-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-cyan-700 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"نام فروشنده"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"شماره تماس"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"نمایش"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"عملیات"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:y.length>0?y.map(t=>e.jsxs("tr",{className:"transition-colors hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-800",children:t.full_name}),e.jsx("td",{className:"px-4 py-3 text-gray-800",children:t.phone}),e.jsx("td",{className:"px-4 py-3 text-center",children:C[t.id]?e.jsx(E,{className:"mx-auto h-5 w-5 animate-spin text-blue-600"}):e.jsx("input",{type:"checkbox",checked:j[t.id]||!1,onChange:()=>_(t.id),className:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"mx-auto space-x-2 space-x-reverse px-4 py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{onClick:()=>S(t),className:"flex items-center gap-1 rounded bg-yellow-500 px-3 py-1 text-xs font-semibold text-white hover:bg-yellow-600",children:[e.jsx(A,{size:14})," ویرایش"]}),e.jsxs("button",{onClick:()=>f(t),className:"flex items-center gap-1 rounded bg-red-600 px-3 py-1 text-xs font-semibold text-white hover:bg-red-700",children:[e.jsx(H,{size:14})," حذف"]})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"py-4 text-center text-gray-500",children:"هیچ فروشنده‌ای یافت نشد."})})})]})})]}),V&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"animate-fadeIn mx-3 w-full max-w-2xl overflow-hidden rounded-2xl bg-white shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 px-6 py-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:d?"ویرایش فروشنده":"ایجاد فروشنده جدید"}),e.jsx("button",{onClick:g,className:"text-xl font-bold leading-none text-gray-500 hover:text-red-600",children:"×"})]}),e.jsx("div",{className:"px-6 py-5",children:e.jsx("form",{onSubmit:F,children:e.jsxs("div",{className:"grid grid-cols-1 gap-5 lg:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-1 text-sm font-medium text-gray-700",children:"نام فروشنده"}),e.jsx("input",{type:"text",value:r.full_name,onChange:t=>p({...r,full_name:t.target.value}),placeholder:"مثلاً: علی رضایی",className:"rounded-md border border-gray-300 px-3 py-2 text-right outline-none transition-all focus:border-sky-500 focus:ring-1 focus:ring-sky-400"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-1 text-sm font-medium text-gray-700",children:"شماره تماس"}),e.jsx("input",{type:"text",value:r.phone,onChange:t=>p({...r,phone:t.target.value}),placeholder:"مثلاً: 09123456789",className:"rounded-md border border-gray-300 px-3 py-2 text-right outline-none transition-all focus:border-sky-500 focus:ring-1 focus:ring-sky-400"})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-end gap-4 lg:col-span-2",children:[e.jsx("button",{type:"submit",disabled:v,className:"rounded-md bg-sky-600 px-5 py-2 font-semibold text-white transition-all hover:bg-sky-700 disabled:opacity-60",children:v?"در حال ذخیره...":"ذخیره"}),e.jsx("button",{type:"button",onClick:g,className:"rounded-md bg-gray-300 px-5 py-2 transition-all hover:bg-gray-400",children:"لغو"})]})]})})})]})}),c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",children:e.jsxs("div",{className:"animate-fadeIn mx-3 w-full max-w-sm rounded-2xl bg-white p-6 shadow-xl",children:[e.jsx("h2",{className:"mb-2 text-center text-lg font-bold text-gray-800",children:"حذف فروشنده"}),e.jsxs("p",{className:"mb-6 text-center text-sm text-gray-600",children:["آیا از حذف فروشنده"," ",e.jsx("span",{className:"font-semibold text-red-600",children:c.full_name})," ","مطمئن هستید؟"]}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx("button",{onClick:()=>f(null),className:"rounded-xl bg-gray-200 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-300",children:"انصراف"}),e.jsx("button",{onClick:T,className:"rounded-xl bg-red-600 px-4 py-2 text-sm font-semibold text-white hover:bg-red-700",children:"حذف کن"})]})]})})]})}export{Q as default};
