import{r as a,b as f,j as e,H as N}from"./app-BqfSY66W.js";import{A as v}from"./AuthenticatedLayout-BD6RdAD5.js";import"./transition-CYzJCn0g.js";import"./createLucideIcon-Hng2jIgv.js";function y({open:o,onClose:n,group:r,members:i}){return o?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-40",onClick:n}),e.jsxs("div",{className:"z-60 max-h-[80vh] w-full max-w-3xl overflow-auto rounded-lg bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold",children:r?.title||r}),e.jsx("button",{onClick:n,className:"text-gray-600 hover:text-gray-900",children:"Close"})]}),e.jsxs("div",{className:"space-y-3",children:[i.length===0&&e.jsx("p",{className:"text-sm text-gray-600",children:"No members found."}),i.map(t=>e.jsxs("div",{className:"flex items-center gap-3 rounded border p-2",children:[e.jsx("img",{src:t.photo_path?`/api/telegram/downloads/${t.phone?.replace("+","")||"unknown"}/${(r.username||r.title||r).replace("/","_")}/${`user_${t.id}.jpg`}`:"https://via.placeholder.com/48?text=No",alt:t.username||t.first_name,className:"h-12 w-12 rounded-full object-cover",onError:d=>d.currentTarget.src="https://via.placeholder.com/48?text=No"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[t.first_name||"—"," ",t.last_name||""]}),e.jsx("div",{className:"text-sm text-gray-500",children:t.username?`@${t.username}`:t.phone||"—"}),t.error&&e.jsx("div",{className:"mt-1 text-xs text-red-600",children:t.error})]})]},t.id))]})]})]}):null}function S(){const[o,n]=a.useState([]),[r,i]=a.useState(!1),[t,d]=a.useState(""),[x,u]=a.useState(null),[g,c]=a.useState([]),[h,p]=a.useState(!1),m=localStorage.getItem("telegram_phone");a.useEffect(()=>{b()},[]);const b=async()=>{i(!0),d("");try{const s=await f.post(route("getMyGroups"),{phone:m});n(s.data.groups||[])}catch(s){d(s.response?.data?.error||"Failed to load groups")}finally{i(!1)}},j=async s=>{u(s),c([]),p(!0);try{const l=await f.post(route("getMyGroups"),{phone:m,group:s.username||s.title||s.id,limit:200});c(l.data.members||[])}catch(l){c([{id:"error",first_name:"Error",error:l.response?.data?.error||"Failed to fetch members"}])}finally{p(!1)}};return e.jsxs(v,{title:"گروه های شما",children:[e.jsx(N,{title:"گروه های شما"}),e.jsxs("div",{className:"mx-auto mt-12 max-w-4xl rounded bg-white p-6 shadow",children:[e.jsx("h1",{className:"mb-4 text-2xl font-bold",children:"گروه‌هایی که عضو هستید"}),e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx("button",{onClick:b,className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",disabled:r,children:r?"Loading...":"Refresh"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["شماره:"," ",e.jsx("span",{className:"font-medium",children:m||"—"})]})]}),t&&e.jsx("div",{className:"mb-4 text-red-600",children:t}),!r&&o.length===0&&e.jsx("p",{className:"text-gray-500",children:"هیچ گروهی یافت نشد."}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:o.map(s=>e.jsxs("div",{className:"flex flex-col justify-between rounded border p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500",children:s.username?`@${s.username}`:`id: ${s.id}`})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{className:"rounded bg-green-500 px-3 py-1 text-white hover:bg-green-600",onClick:()=>j(s),children:"View members"}),e.jsx("button",{className:"rounded bg-gray-200 px-3 py-1 text-gray-800",onClick:()=>{const l=s.username||s.id;navigator.clipboard?.writeText(l),alert("Copied: "+l)},children:"Copy id/username"})]})]},s.id))}),e.jsx(y,{open:!!x,onClose:()=>{u(null),c([])},group:x,members:h?[]:g}),h&&e.jsx("div",{className:"fixed bottom-6 right-6 rounded bg-white p-3 shadow",children:"Loading members..."})]})]})}export{S as default};
